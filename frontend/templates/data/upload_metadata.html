{% extends "dashboard/layout.html" %}
{% block title %}Upload Metadata | FAIRMicrobiome{% endblock %}

{% block content %}
<div class="row justify-content-center">
   {% with messages = get_flashed_messages(with_categories=true) %}
   {% if messages %}
      <div class="container mt-3">
         {% for category, message in messages %}
         <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
         </div>
         {% endfor %}
      </div>
   {% endif %}
   {% endwith %}

   <h1>Upload Sample Metadata
      <small class="text-muted">{{ table_name }}</small>
   </h1>
   <div style="height:3vh;"></div>

   <div class="row">
      <div class="col-md-8">
         <div class="card">
            <div class="card-header">
               <h5><i class="fas fa-upload"></i> Upload Metadata CSV</h5>
            </div>
            <div class="card-body">
               <form method="POST" enctype="multipart/form-data">
                  <div class="mb-3">
                     <label for="metadata_file" class="form-label">Select CSV File</label>
                     <input type="file" class="form-control" id="metadata_file"
                            name="metadata_file" accept=".csv" required>
                     <small class="form-text text-muted">
                        CSV file with sample metadata. Must include 'sample_id' column.
                     </small>
                  </div>

                  <button type="submit" class="btn btn-primary-custom">
                     <i class="fas fa-upload"></i> Upload Metadata
                  </button>
                  <a href="/visualization" class="btn btn-secondary">Cancel</a>
               </form>
            </div>
         </div>
      </div>

      <div class="col-md-4">
         <div class="card">
            <div class="card-header">
               <h5><i class="fas fa-info-circle"></i> Instructions</h5>
            </div>
            <div class="card-body">
               <p><strong>CSV Format:</strong></p>
               <pre>sample_id,treatment,timepoint
Sample1,Control,Day0
Sample2,Drug_A,Day7</pre>

               <p class="mt-3">
                  Your CSV must include a <code>sample_id</code> column with sample IDs that match your dataset.
                  You can include any additional metadata fields you need.
               </p>
            </div>
         </div>
      </div>
   </div>
</div>
{% endblock %}
